<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Devtools components test</title>
</head>
<body>
  <app-comp></app-comp>
  <script type="module">
    import { createCustomElement } from 'https://cdn.skypack.dev/ficusjs@3/custom-element'
    import { createComponent } from 'https://cdn.skypack.dev/ficusjs@3/component'
    import { html, renderer } from 'https://cdn.skypack.dev/@ficusjs/renderers@3/htm'

    createCustomElement('app-comp', {
      renderer,
      render () {
        return html`
          <h1>Component test</h1>
          <child-comp person-name="Matt" siblings='["Michelle","Graeme","Imogen"]'></child-comp>
          <child-comp></child-comp>
          <state-comp></state-comp>
        `
      }
    })

    createCustomElement('child-comp', {
      renderer,
      props: {
        personName: {
          type: String
        },
        age: {
          type: Number
        },
        siblings: {
          type: Object,
          default: []
        }
      },
      render () {
        return html`
          <p>
            Hi, there! My name is ${this.props.personName}
          </p>
          ${this.props.siblings && Array.isArray(this.props.siblings) && this.props.siblings.length > 0
            ? html`<div>
              <p>My siblings are:</p>
              <ul>
                ${this.props.siblings.map(s => html`<li>${s}</li>`)}
              </ul>
              </div>
            `
            : html`<span />`}
          <fav-comp favourites='{"Favourite biscuit":"Bourbon","Favourite beer":"Whitstable Bay"}'></fav-comp>
          <date-comp></date-comp>
        `
      }
    })

    createCustomElement('date-comp', {
      computed: {
        today () {
          return new Date().toLocaleDateString()
        }
      },
      render () {
        return `
          <p>
            Todays date is ${this.today}
          </p>
        `
      }
    })

    createCustomElement('fav-comp', {
      renderer,
      props: {
        favourites: {
          type: Object,
          default: {}
        }
      },
      render () {
        return html`
          ${this.props.favourites && Object.keys(this.props.favourites).length > 0
          ? html`<ul>
                ${Object.keys(this.props.favourites).map(k => html`<li>${k} is ${this.props.favourites[k]}</li>`)}
              </ul>
            `
          : html`<span />`}
        `
      }
    })

    createComponent('state-comp', {
      state () {
        return {
          count: 0
        }
      },
      increment () {
        this.setState(state => ({ ...state, count: state.count + 1 }))
      },
      render () {
        return html`
          <div>
            <p>
              Count is ${this.state.count}
            </p>
            <button type="button" onclick="${this.increment}">Increment</button>
          </div>
        `
      }
    })
  </script>
</body>
</html>